{% extends "dashboard/doctor/header_base.html" %}
{% load static %}
{% block content %}
<link href="{% static 'dashboard/vendor/datatables/dataTables.bootstrap4.min.css' %}" rel="stylesheet">
<style type="text/css">
   .sp-container {
   display: -webkit-box;
   display: -ms-flexbox;
   display: flex;
   -webkit-box-align: center;
   -ms-flex-align: center;
   align-items: center;
   -webkit-box-pack: center;
   -ms-flex-pack: center;
   justify-content: center;
   min-height: 100vh;
   background-color: transparent;
   position: absolute;
   left: 45%;
   z-index: 99999;
   display: none;
   top: 27%;
   }
   .loader {
   max-width: 15rem;
   width: 50%;
   height: auto;
   stroke-linecap: round;
   }
   circle {
   fill: none;
   stroke-width: 3.5;
   -webkit-animation-name: preloader;
   animation-name: preloader;
   -webkit-animation-duration: 3s;
   animation-duration: 3s;
   -webkit-animation-iteration-count: infinite;
   animation-iteration-count: infinite;
   -webkit-animation-timing-function: ease-in-out;
   animation-timing-function: ease-in-out;
   -webkit-transform-origin: 170px 170px;
   transform-origin: 170px 170px;
   will-change: transform;
   }
   circle:nth-of-type(1) {
   stroke-dasharray: 550;
   }
   circle:nth-of-type(2) {
   stroke-dasharray: 500;
   }
   circle:nth-of-type(3) {
   stroke-dasharray: 450;
   }
   circle:nth-of-type(4) {
   stroke-dasharray: 300;
   }
   circle:nth-of-type(1) {
   -webkit-animation-delay: -0.15s;
   animation-delay: -0.15s;
   }
   circle:nth-of-type(2) {
   -webkit-animation-delay: -0.3s;
   animation-delay: -0.3s;
   }
   circle:nth-of-type(3) {
   -webkit-animation-delay: -0.45s;
   -moz-animation-delay:  -0.45s;
   animation-delay: -0.45s;
   }
   circle:nth-of-type(4) {
   -webkit-animation-delay: -0.6s;
   -moz-animation-delay: -0.6s;
   animation-delay: -0.6s;
   }
   @-webkit-keyframes preloader {
   50% {
   -webkit-transform: rotate(360deg);
   transform: rotate(360deg);
   }
   }
   @keyframes preloader {
   50% {
   -webkit-transform: rotate(360deg);
   transform: rotate(360deg);
   }
   }
</style>
<div class="sp-container" id="preloader">
   <svg class="loader" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 340 340">
      <circle cx="170" cy="170" r="160" stroke="#4e73df"/>
      <circle cx="170" cy="170" r="135" stroke="#6f42c1"/>
      <circle cx="170" cy="170" r="110" stroke="#4e73df"/>
      <circle cx="170" cy="170" r="85" stroke="#6f42c1"/>
   </svg>
</div>
<script src="{% static 'dashboard/vendor/jquery/jquery.min.js' %}"></script>
<script type="text/javascript">
   function show_dis() {
      $(".Disabled").show();
      // body...
   }
   function remove_dis() {
      $(".Disabled").hide();
      // body...
   }
   function show_other() {
     $("#disability_other").show();
   }
   function remove_other() {
     $("#disability_other").hide();
   }
</script>
<!-- Page Wrapper -->
<div id="wrapper">
   <!-- Sidebar -->
   {% include "dashboard/doctor/sidebar.html" %}
   <!-- End of Sidebar -->
   <!-- Content Wrapper -->
   <div id="content-wrapper" class="d-flex flex-column">
      <!-- Main Content -->
      <div id="content">
         <!-- Topbar -->
         {% include "dashboard/doctor/top_bar.html" %}
         <!-- End of Topbar -->
         <!-- Begin Page Content -->
         <div class="container-fluid">
            <!-- Page Heading -->
            <h1 class="h3 mb-2 text-gray-800">Current Case Id:{{case_id}} and Consultancy Id: {{consult_id}}</h1>
            <p class="mb-4"></p>
            <div class="card shadow mb-4">
               <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-danger">Basic Medical Details{{message}}</h6>
               </div>
               <div class="card-body p-0">
                  {% with x=basic_med %}
                  <fieldset>
                     <!-- Form Name -->
                     <div class="container">
                        
                        <div class="row">
                           <div class="col-sm-6">
                              <!-- Text input-->
                              <div class="form-group">
                                 <label class=" control-label" >Full Name</label>  
                                 <input readonly   name="name" type="text" placeholder="Full Name" value="{{user_patient.firstname}} {{user_patient.lastname}}" class="form-control input-md" >
                              </div>
                              <div class="form-group">
                                 <label class=" control-label" >Gender</label>  
                                 <input readonly  id="Gender" name="Gender" type="text" placeholder="Gender" value="{{user_patient.get_gender_display}}" class="form-control input-md" >
                              </div>
                              <div class="form-group">
                                 <label class=" control-label" >Blood Group</label>  
                                 <input readonly   name="Gender" type="text" placeholder="Gender" value="{{user_patient.blood_group}}" class="form-control input-md" >
                              </div>
                              <div class="form-group">
                                 <label class=" control-label" >Date of Birth</label>  
                                 <input readonly   name="Gender" type="text" placeholder="Gender" value="{{user_patient.dateofBirth}}" class="form-control input-md" >
                              </div>
                              <div class="form-group">
                                 <label class=" control-label" >Height</label>  
                                 <input readonly  id="height" name="height" type="text" placeholder="Height (in cms)" value="{{x.height}}" class="form-control input-md" >
                              </div>
                              <!-- Text input-->
                              <div class="form-group">
                                 <label class=" control-label" for="weight">Weight</label>  
                                 <input readonly id="weight" name="weight" type="text"value="{{x.weight}}" placeholder="Weight(in Kgs)" class="form-control input-md">
                              </div>
                              <div class="form-group">
                                 <label class="control-label" for="martial_s">Martial Status*</label>
                                 <select disabled class="form-control" id="martial_s" name="martial_s" required>
                                    <option value="S" >Single</option>
                                    <option value="M" selected>Married</option>
                                    <option value="D">Divorced</option>
                                    <option value="W">Widowed</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('martial_s')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.martial_s}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label mr-5" for="pregnency">Pregnent</label>
                                 <div class="form-check-inline">
                                    <label class="form-check-label">
                                    <input disabled type="radio" class="form-check-input"  name="pregnency" value="1">YES
                                    </label>
                                 </div>
                                 <div class="form-check-inline">
                                    <label class="form-check-label">
                                    <input disabled type="radio" class="form-check-input" name="pregnency" value="0" >NO
                                    </label>
                                 </div>
                              </div>
                              <script type="text/javascript">
                                 var p = document.getElementsByName('pregnency');
                                   for (var i = 0; i <p.length; i++) {
                                     if("{{x.pregnency}}"=="True")
                                     {
                                       var y=1;
                                     }
                                     else
                                     {
                                       var y=0;
                                     }
                                   if(p[i].value==y)
                                   {
                                 
                                     p[i].checked=true;
                                   }
                                   else
                                   {
                                      p[i].checked=false;
                                   }
                                 }
                                 
                              </script>
                              <div class="form-group">
                                 <label class="control-label mr-5" for="disability_status">Are you Disabled Person?</label>
                                 <div class="form-check-inline">
                                    <label class="form-check-label">
                                    <input disabled type="radio" class="form-check-input" onclick="show_dis()" value="1" name="disability_status" >YES
                                    </label>
                                 </div>
                                 <div class="form-check-inline">
                                    <label class="form-check-label">
                                    <input disabled type="radio" class="form-check-input" name="disability_status" value="0" onclick="remove_dis()" >NO
                                    </label>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="Disabled" style="display: none;">
                                 <div class="form-group">
                                    <label class="control-label" for="disability_type">Disability Type*</label>
                                    <select disabled class="form-control" id="disability_type" name="disability_type" >
                                       <option onclick="remove_other()">Please Select</option>
                                       <option value="VI" onclick="remove_other()">Vision Impairment</option>
                                       <option value="DF" onclick="remove_other()">Deaf or Hard of hearing</option>
                                       <option value="MH" onclick="remove_other()">Mental health Conditions</option>
                                       <option value="ID" onclick="remove_other()">Intellectual Disability</option>
                                       <option value="AB" onclick="remove_other()">Acquired Brain Injury</option>
                                       <option value="AS" onclick="remove_other()">Autism Spectrum Disorder</option>
                                       <option value="PD" onclick="remove_other()">Physical Disability</option>
                                       <option value="OT" onclick="show_other()">Other</option>
                                    </select>
                                 </div>
                                 <div class="form-group" style="display: none;" id="disability_other">
                                    <label class=" control-label" >Other Type</label>  
                                    <input readonly  name="disability_other" type="text" value="{{x.disability_other}}" placeholder="Please mention" class="form-control input-md" >
                                 </div>
                              </div>
                              <div class="form-group">
                                 <label class="control-label" for="vision">Vision*</label>
                                 <select disabled class="form-control" name="vision" id="vision" required>
                                    <option value="0">Blind</option>
                                    <option value="1">Nearly Blind</option>
                                    <option value="2">Having just Specs</option>
                                    <option value="3" selected>OK</option>
                                    <option value="4">Good</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var p = document.getElementsByName('disability_status');
                                   for (var i = 0; i <p.length; i++) {
                                     if("{{x.disability_status}}"=="True")
                                     {
                                       var y=1;
                                     }
                                     else
                                     {
                                       var y=0;
                                     }
                                   if(p[i].value==y)
                                   {
                                     if(y==1)
                                     {
                                      show_dis();
                                     }
                                 
                                     p[i].checked=true;
                                   }
                                   else
                                   {
                                      p[i].checked=false;
                                   }
                                 }
                                 
                                 var select=document.getElementById('vision')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.vision}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                                  var select=document.getElementById('disability_type')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.disability_type}}")
                                   {
                                     if(select.options[i].value=="OT")
                                     {
                                       show_other();
                                     }
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label" for="alcohol">Alcohol Consumption*</label>
                                 <select disabled class="form-control" id="alcohol" name="alcohol"  required>
                                    <option value="0">Severely Addicted</option>
                                    <option value="1">Once in a day</option>
                                    <option value="2">Once or twice a Week</option>
                                    <option value="3">Not Regulary</option>
                                    <option value="4" selected>Not touched in Life</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('alcohol')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.alcohol}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label" for="smoking">Smoking Consumption*</label>
                                 <select disabled class="form-control" id="smoking"  name="smoking" required>
                                    <option value="0">Severely Addicted</option>
                                    <option value="1">Once in a day</option>
                                    <option value="2">Once or twice a Week</option>
                                    <option value="3">Not Regulary</option>
                                    <option value="4" selected>Not touched in Life</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('smoking')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.smoking}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label" for="vision">Color Vision *</label>
                                 <select disabled class="form-control" id="color_vison" name="color_vison" required>
                                    <option value="0">Color Blind</option>
                                    <option value="1">Nearly Blind</option>
                                    <option value="2">Bad Color Vision</option>
                                    <option value="3" selected>OK</option>
                                    <option value="4">Good</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('color_vison')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.color_vison}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label" for="smoking">Masturbating*</label>
                                 <select disabled class="form-control"  id="masturbating" name="masturbating" required>
                                    <option value="0">Severely Addicted</option>
                                    <option value="1">Once in a day</option>
                                    <option value="2">Once or twice a Week</option>
                                    <option value="3">Not Regulary</option>
                                    <option value="4" selected>Not to be disclose</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('masturbating')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.masturbating}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <div class="form-group">
                                 <label class="control-label" for="smoking">Drugs*</label>
                                 <select disabled class="form-control" id="drugs" name="drugs" required>
                                    <option value="0">Severely Addicted</option>
                                    <option value="1">Once in a day</option>
                                    <option value="2">Once or twice a Week</option>
                                    <option value="3">Not Regulary</option>
                                    <option value="4" selected>Not touched in Life</option>
                                 </select>
                              </div>
                              <script type="text/javascript">
                                 var select=document.getElementById('drugs')
                                 var len=select.options.length;
                                 for (var i = 0; i <len; i++) {
                                   if(select.options[i].value=="{{x.drugs}}")
                                   {
                                     
                                     select.options[i].selected=true;
                                   }
                                   else 
                                   {
                                     select.options[i].selected=false;
                                   
                                   }
                                 }
                              </script>
                              <!-- Textarea -->
                              <div class="form-group">
                                 <label class=" control-label" for="other_details">Other Problems you want to Mention</label>
                                 <textarea readonly class="form-control" value="{{x.other_details}}" name="other_details" >{{x.other_details}}</textarea>
                              </div>
                           </div>
                        </div>
                     </div>
                  </fieldset>
                  {% endwith %}   
               </div>
            </div>
            <div class="card shadow mb-4">
               <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-danger">Previous Surgical Details</h6>
               </div>
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="table table-bordered" id="dataTable2" width="100%" cellspacing="0">
                        <thead>
                           <tr>
                              <th>Id</th>
                              <th>Surgery type</th>
                              <th>Surgery description</th>
                              <th>Date of Surgery</th>
                              <th>Surgery file</th>
                              <th>Hospital Name</th>
                              <th>Hospital Location</th>
                              
                           </tr>
                        </thead>
                        <tfoot>
                           <tr>
                              <th>Id</th>
                              <th>Surgery type</th>
                              <th>Surgery description</th>
                              <th>Date of Surgery</th>
                              <th>Surgery file</th>
                              <th>Hospital Name</th>
                              <th>Hospital Location</th>
                           </tr>
                        </tfoot>
                        <tbody>
                           {% for ajax in surgery %}
                           <tr id="table-{{forloop.counter0}}">
                              <td>{{ ajax.id }}</td>
                              <td>{{ ajax.surgery_type }}</td>
                              <td>{{ ajax.surgery_description }}</td>
                              <td>{{ ajax.dateofSurgery }}</td>
                              <td><a href="{{ ajax.surgery_file.url }}" class="btn btn-info btn-icon-split" download><span class="icon text-white-50">
                                 <i class="fas fa-arrow-right"></i>
                                 </span><span class="text">Click</span></a>
                              </td>
                              <td>{{ ajax.hospital_name }}</td>
                              <td>{{ ajax.hospital_location}}</td>
                              
                           </tr>
                           {% endfor %}
                        </tbody>
                     </table>
                  </div>
               </div>
            </div>
             <div class="card shadow mb-4">
               <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-danger">User Medication Details</h6>
               </div>
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="table table-bordered dataTable" width="100%" cellspacing="0">
                        <thead>
                           <tr>
                              <th>Id</th>
                              <th>Medicine Name</th>
                              <th>Medicine Dosage</th>
                              <th>Medicine Quantity</th>
                              <th>Action</th>
                           </tr>
                        </thead>
                        <tfoot>
                           <tr>
                              <th>Id</th>
                              <th>Medicine Name</th>
                              <th>Medicine Dosage</th>
                              <th>Medicine Quantity</th>
                              <th>Action</th>
                           </tr>
                        </tfoot>
                        <tbody>
                           {% for ajax in user_medicines_e %}
                           <tr id="table-{{forloop.counter0}}">
                              <td>{{ ajax.id }}</td>
                              <td>{{ ajax.medicine_name }}</td>
                              <td>{{ ajax.dosage }}</td>
                              <td>{{ ajax.quantity }}</td>
                              <td><a href="#" class="btn btn-danger btn-icon-split" onclick="delete_med_entry('{{ ajax.id }}')" ><span class="icon text-white-50">
                                 <i class="fas fa-arrow-right"></i>
                                 </span><span class="text">DELETE</span></a>
                              </td>
                              
                              
                           </tr>
                           {% endfor %}
                        </tbody>
                     </table>
                  </div>
               </div>
            </div>
            <div class="card shadow mb-4">
               <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-danger">Previous Cases of User Details</h6>
               </div>
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                        <thead>
                           <tr>
                              <th>ID</th>
                              <th>Symptoms</th>
                              <th>Diseases</th>
                              <th>Injuries</th>
                              <th>General Notes</th>
                              <th>Case of Injury?</th>
                              <th>Closed</th>
                              <th>Consultancy & Medicine</th>
                              <th>Lab Reports</th>
                           </tr>
                        </thead>
                        <tfoot>
                           <tr>
                              <th>ID</th>
                              <th>Symptoms</th>
                              <th>Diseases</th>
                              <th>Injuries</th>
                              <th>General Notes</th>
                              <th>Case of Injury?</th>
                              <th>Closed</th>
                              <th>Consultancy & Medicine</th>
                              <th>Lab Reports</th>
                           </tr>
                        </tfoot>
                        <tbody>
                           {% for ajax in cases_ %}
                           {% if not forloop.last  %}
                           <tr id="table-{{forloop.counter0}}">
                              <th>{{ ajax.id }}</th>
                              <td>{{ ajax.symptoms }}</td>
                              <td>{{ ajax.diseases }}</td>
                              <td>{{ ajax.injury_type }}</td>
                              <td>{{ ajax.general_notes }}</td>
                              <td>{{ ajax.is_accidental}}</td>
                              <td>{{ ajax.is_closed}}</td>
                              <td><a href="#" onclick="getajaxconsultancy('{{ajax.id}}')" class="btn btn-info btn-icon-split" data-toggle="modal" data-target="#doc_cons{{ajax.id}}"><span class="icon text-white-50">
                                 <i class="fas fa-arrow-right"></i>
                                 </span><span class="text">Click</span></a>
                                <!-- The Modal -->
                                <div class="modal " id="doc_cons{{ajax.id}}">
                                  <div class="modal-dialog mw-100">
                                    <div class="modal-content">
                                      <!-- Modal Header -->
                                      <div class="modal-header">
                                        <h4 class="modal-title">Case ID: {{ ajax.id }}</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                      </div>
                                      <!-- Modal body -->
                                      <div class="modal-body" id="doc_cons_body{{ajax.id}}">
                                       <div class="table-responsive">
                                            <table class="table table-bordered"  width="100%" cellspacing="0">
                                              <thead>
                                                <tr>
                                                  <!-- <th>Id</th> -->
                                                  <th>Entry Date</th>
                                                  <th>Symptoms</th>
                                                  <th>Injuries</th>
                                                  <th>Diseases</th>
                                                  <th>Personal notes</th>
                                                  <th>General notes</th>
                                                  <th>Case of Injury?</th>
                                                </tr>
                                              </thead>
                                              <tfoot>
                                                <tr>
                                                   <!-- <th>Id</th> -->
                                                  <th>Entry Date</th>
                                                  <th>Symptoms</th>
                                                  <th>Injuries</th>
                                                  <th>Diseases</th>
                                                  <th>Personal notes</th>
                                                  <th>General notes</th>
                                                  <th>Case of Injury?</th>
                                                </tr>
                                              </tfoot>
                                              <tbody id="tbody-{{ajax.id}}">
                                              </tbody>
                                            </table>
                                          </div>
                                          <h1>List of Medicines</h1>
                                          <style type="text/css">
                                            #special-th  th, #special-th tbody td
                                            {
                                              color: #fff;
                                            }
                                          </style>
                                          <div class="table-responsive bg-info" id="special-th">
                                            <table class="table table-bordered"  width="100%" cellspacing="0">
                                              <thead>
                                                <tr>
                                                 
                                                  <th >Medicine Name</th>
                                                  <th>Dosage</th>
                                                  <th>Quantity</th>
                                                  <th>Is it delivered?</th>
                                                  
                                                </tr>
                                              </thead>
                                              <tfoot>
                                                <tr>
                                                 
                                                  <th>Medicine Name</th>
                                                  <th>Dosage</th>
                                                  <th>Quantity</th>
                                                  <th>Is it delivered?</th>
                                                  
                                                </tr>
                                              </tfoot>
                                              <tbody id="tbody4-{{ajax.id}}">
                                              </tbody>
                                            </table>
                                          </div>
                                      </div>
                                      <!-- Modal footer -->
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </td>
                              <td><a href="#" onclick="getajaxlab('{{ajax.id}}')" class="btn btn-info btn-icon-split" data-toggle="modal" data-target="#doc_lab{{ajax.id}}"><span class="icon text-white-50">
                                 <i class="fas fa-arrow-right"></i>
                                 </span><span class="text">Click</span></a>
                                <!-- The Modal -->
                                <div class="modal " id="doc_lab{{ajax.id}}">
                                  <div class="modal-dialog mw-100">
                                    <div class="modal-content">
                                      <!-- Modal Header -->
                                      <div class="modal-header">
                                        <h4 class="modal-title">Case ID: {{ ajax.id }}</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                      </div>
                                      <!-- Modal body -->
                                      <div class="modal-body" id="doc_cons_body{{ajax.id}}">
                                        <h4 class="modal-title">LAB Reports:</h4>
                                       <div class="table-responsive">
                                            <table class="table table-bordered"  width="100%" cellspacing="0">
                                              <thead>
                                                <tr>
                                                  <th>Name</th>
                                                  <th>Refered Date</th>
                                                  <th>Delivered Date</th>
                                                  <th>Is delivered</th>
                                                  <th>Description by lab</th>
                                                  <th>Files</th>
                                                </tr>
                                              </thead>
                                              <tfoot>
                                                <tr>
                                                  <th>Name</th>
                                                  <th>Refered Date</th>
                                                  <th>Delivered Date</th>
                                                  <th>Is delivered</th>
                                                  <th>Description by lab</th>
                                                  <th>Files</th>
                                                </tr>
                                              </tfoot>
                                              <tbody id="tbody5-{{ajax.id}}">
                                              </tbody>
                                            </table>
                                          </div>
                                          
                                      </div>
                                      <!-- Modal footer -->
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </td>

                           </tr>
                           {% endif %}
                           {% endfor %}
                        </tbody>
                     </table>
                  </div>
               </div>
            </div>
            
            
            <div class="card shadow mb-4">
               <div class="card-header py-3">
                  <h6 class="m-0 font-weight-bold text-danger">Previous Consultancy of Same Case</h6>
               </div>
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="table table-bordered dataTable"  width="100%" cellspacing="0">
                        <thead>
                            <tr>
                              <!-- <th>Id</th> -->
                              <th>Entry Date</th>
                              <th>Symptoms</th>
                              <th>Injuries</th>
                              <th>Diseases</th>
                              <th>Personal notes</th>
                              <th>General notes</th>
                              <th>Case of Injury?</th>
                            </tr>
                          </thead>
                          <tfoot>
                            <tr>
                               <!-- <th>Id</th> -->
                              <th>Entry Date</th>
                              <th>Symptoms</th>
                              <th>Injuries</th>
                              <th>Diseases</th>
                              <th>Personal notes</th>
                              <th>General notes</th>
                              <th>Case of Injury?</th>
                            </tr>
                          </tfoot>
                          <tbody id="tbody2-{{case_id}}">
                          </tbody>
                        </table>                
                  </div>
               </div>
            </div>
            
            <div class="card o-hidden border-0 shadow-lg my-5">
               <div class="card-body p-0">
                  <!-- Nested Row within Card Body -->
                  <div class="card-header py-3">
                     <h6 class="m-0 font-weight-bold text-danger">Enter Details for Patient Counselling</h6>
                  </div>
                  <div class="card-body">
                     <div class="text-center">
                        <!-- <h1 class="h4 text-gray-900 mb-4">Welcome Back!<br/></h1> -->
                        <h1 class="h4 text-gray-900 mb-4">Fill Diseases/ Injuries with respective Symptoms</h1>
                        <p class="mb-4">We get it, stuff happens. Just enter your email address below and we'll send you a link to reset your password!</p>
                        {{message}}
                        <script>
                           {% if messages %}
                               {% for message in messages %}
                                   alert(message);
                               {% endfor %}
                           {% endif %}
                        </script>
                        {% if form.errors %}
                        {% for field in form %}
                        {% for error in field.errors %}
                        <div class="alert alert-danger">
                           <strong>Field Error{{ error|escape }}</strong>
                        </div>
                        {% endfor %}
                        {% endfor %}
                        {% for error in form.non_field_errors %}
                        <div class="alert alert-danger">
                           <strong>Non Field Error{{ error|escape }}</strong>
                        </div>
                        {% endfor %}
                        {% endif %}
                     </div>
                     <div class="row">
                        <div class="col-sm-6">
                           <center>
                              <button type="button" class="btn btn-primary my-2" data-toggle="modal" data-target="#myModal1">
                              Click here to add new Symptom in database</button>
                           </center>
                        </div>
                        <div class="modal" id="myModal1">
                           <div class="modal-dialog">
                              <div class="modal-content">
                                 <!-- Modal Header -->
                                 <div class="modal-header">
                                    <h4 class="modal-title">Symptom Addition </h4>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                 </div>
                                 <!-- Modal body -->
                                 <div class="modal-body">
                                    <center>
                                       <button type="button" class="btn btn-primary my-2" data-toggle="modal" data-target="#myModal3">
                                       Click here to add new Symptom Category
                                       </button>
                                    </center>
                                    <div class="modal" id="myModal3">
                                       <div class="modal-dialog">
                                          <div class="modal-content">
                                             <!-- Modal Header -->
                                             <div class="modal-header">
                                                <h4 class="modal-title">Symptom Category Addition</h4>
                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                             </div>
                                             <!-- Modal body -->
                                             <div class="modal-body">
                                                <form class="user" action="" method='POST' id="symptom_cat">
                                                   {% csrf_token %} 
                                                   <div class="form-group">
                                                      <input type="text" class="form-control m-1" id="symptom_cat_name" name="symptom_cat_name" placeholder="Enter Symptom Name" required>
                                                      <textarea type="text" class="form-control m-1 " id="symptom_cat_desc" name="symptom_cat_desc" placeholder="Enter Symptom Description" required></textarea>
                                                   </div>
                                                   <center><input type='submit' name='submit' class="btn btn-primary btn-user btn-block w-50"/></center>
                                                </form>
                                             </div>
                                             <!-- Modal footer -->
                                             <div class="modal-footer">
                                                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    <form class="user" action="" method='POST' id="symptom_sub">
                                       {% csrf_token %} 
                                       <div class="form-group">
                                          <input type="text" class="form-control m-1" id="symptom_name" name="symptom_name" placeholder="Enter Symptom Name" required>
                                          <input type="text" class="form-control m-1" id="alternate_name" name="alternate_name" placeholder="Enter Alternate names" required>
                                          <textarea type="text" class="form-control m-1 " id="symptom_desc" name="symptom_desc" placeholder="Enter Symptom Description" required></textarea>
                                          <div class="form-group">
                                             <label class="control-label" for="martial_s">Symptom Category</label>
                                             <select  class="form-control" id="symptom_cat_select_modal" name="symptom_cat_select_modal" required>
                                                <option selected>--Select from below--</option>
                                                {% for x in sys_cat %}
                                                <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>
                                                {% endfor %}
                                             </select>
                                          </div>
                                       </div>
                                       <center><input type='submit' name='submit' class="btn btn-primary btn-user btn-block w-50"/></center>
                                    </form>
                                 </div>
                                 <!-- Modal footer -->
                                 <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="col-sm-6">
                           <center>
                              <button type="button" class="btn btn-primary my-2" data-toggle="modal" data-target="#diseasemodal1">
                              Click here to add new Disease in database</button>
                           </center>
                        </div>
                        <div class="modal" id="diseasemodal1">
                           <div class="modal-dialog">
                              <div class="modal-content">
                                 <!-- Modal Header -->
                                 <div class="modal-header">
                                    <h4 class="modal-title">Disease Addition </h4>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                 </div>
                                 <!-- Modal body -->
                                 <div class="modal-body">
                                    <center>
                                       <button type="button" class="btn btn-primary my-2" data-toggle="modal" data-target="#diseasemodal2">
                                       Click here to add new Disease Category
                                       </button>
                                    </center>
                                    <div class="modal" id="diseasemodal2">
                                       <div class="modal-dialog">
                                          <div class="modal-content">
                                             <!-- Modal Header -->
                                             <div class="modal-header">
                                                <h4 class="modal-title">Disease Category Addition</h4>
                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                             </div>
                                             <!-- Modal body -->
                                             <div class="modal-body">
                                                <form class="user" action="" method='POST' id="disease_cat">
                                                   {% csrf_token %} 
                                                   <div class="form-group">
                                                      <input type="text" class="form-control m-1" id="disease_cat_name" name="symptom_cat_name" placeholder="Enter Disease Category" required>
                                                      <textarea type="text" class="form-control m-1 " id="disease_cat_desc" name="symptom_cat_desc" placeholder="Enter Description" required></textarea>
                                                   </div>
                                                   <center><input type='submit' name='submit' class="btn btn-primary btn-user btn-block w-50"/></center>
                                                </form>
                                             </div>
                                             <!-- Modal footer -->
                                             <div class="modal-footer">
                                                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    <form class="user" action="" method='POST' id="disease_sub">
                                       {% csrf_token %} 
                                       <div class="form-group">
                                          <input type="text" class="form-control m-1" id="disease_name" name="disease_name" placeholder="Enter Disease Name" required>
                                          <input type="text" class="form-control m-1" id="dis_alternate_name" name="dis_alternate_name" placeholder="Enter Alternate names" required>
                                          <textarea type="text" class="form-control m-1 " id="disease_desc" name="disease_desc" placeholder="Enter Disease Description" required></textarea>
                                          <div class="form-group">
                                             <label class="control-label" for="disease_cat_select_modal">Disease Category</label>
                                             <select  class="form-control" id="disease_cat_select_modal" name="disease_cat_select_modal" required>
                                                <option selected>--Select from below--</option>
                                                {% for x in dis_cat %}
                                                <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>
                                                {% endfor %}
                                             </select>
                                          </div>
                                          <div class="form-group">
                                             <label class="control-label" for="dis_int">DISEASE INTENSITY</label>
                                             <select  class="form-control" id="dis_int" name="dis_int" required>
                                                <option selected>--Select from below--</option>
                                                <option value="Ordinary">Ordinary</option>
                                                <option value="Communicable">Communicable</option>
                                                <option value="Threat_to_region">Threat_to_region</option>
                                                <option value="Threat_to_country">Threat_to_country</option>
                                                <option value="Threat_to_humanity">Threat_to_humanity</option>
                                             </select>
                                          </div>
                                       </div>
                                       <center><input type='submit' name='submit' class="btn btn-primary btn-user btn-block w-50"/></center>
                                    </form>
                                 </div>
                                 <!-- Modal footer -->
                                 <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="col-sm-12">
                           <center>
                              <button type="button" class="btn btn-primary my-2" data-toggle="modal" data-target="#myModal2">
                              Click here to add new Injury
                              </button>
                           </center>
                           <div class="modal" id="myModal2">
                              <div class="modal-dialog">
                                 <div class="modal-content">
                                    <!-- Modal Header -->
                                    <div class="modal-header">
                                       <h4 class="modal-title">Injury Addition</h4>
                                       <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    </div>
                                    <!-- Modal body -->
                                    <div class="modal-body">
                                       <form class="user" action="" method='POST' id="injury_form">
                                          {% csrf_token %} 
                                          <div class="form-group">
                                             <input type="text" class="form-control m-1" id="injury_name" name="injury_name" placeholder="Enter Injury Name" required>
                                             <input type="text" class="form-control m-1" id="inj_alternate_name" name="alternate_name" placeholder="Enter Alternate names" required>
                                             <textarea type="text" class="form-control m-1 " id="injury_desc" name="injury_desc" placeholder="Enter Injury Description" required></textarea>
                                             <div class="form-group">
                                                <label class="control-label" for="inj_sev">Injury Severity</label>
                                                <select  class="form-control" id="inj_sev" name="inj_sev" required>
                                                   <option selected>--Select from below--</option>
                                                   <option value="Ordinary">Ordinary</option>
                                                   <option value="highly_severe">Highly_Severe</option>
                                                   <option value="capable_of_handicapping">Capable of Handicapping</option>
                                                   <option value="Life_threatning">Life threatning</option>
                                                </select>
                                             </div>
                                          </div>
                                          <center><input type='submit' name='submit' class="btn btn-primary btn-user btn-block w-50"/></center>
                                       </form>
                                    </div>
                                    <!-- Modal footer -->
                                    <div class="modal-footer">
                                       <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <script type="text/javascript">
                        //Common Fuction
                          function delete_e(t) {
                          // console.log(t.previousSibling.previousSibling,t.previousSibling.previousSibling.value);
                          t.parentElement.previousSibling.previousSibling.remove();
                          // console.log(t.previousSibling,t.previousSibling.value);
                          t.parentElement.previousSibling.remove();
                          // console.log(t,t.parentNode);
                          t.parentElement.parentNode.remove();
                          t.remove();
                          }
                          function add_sympt_form()
                          {
                            var div_to_be_appended = $("<div class='symptoms_id_entry row'></div>").html('<div class="form-group col-sm-5"> <label class="control-label" for="symptcat_entry">Symptom Category</label> <select  class="form-control symptcat_entry" id="symptcat_entry" name="symptcat_entry" required> <option selected>--Select from below--</option> {% for x in sys_cat %} <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option> {% endfor %} </select> </div> <div class="form-group col-sm-5"> <label class="control-label" for="sympt_entry">Symptom Name</label> <select  class="form-control sympt_entry" id="sympt_entry" name="sympt_entry" required> <option selected>--Select from below--</option> </select> </div> <div class=" col-sm-2"> <button type="button" class="btn btn-primary my-3 py-3" onclick="delete_e(this)"> Delete</button> </div>');
                          // console.log(div_to_be_appended.html());
                          $('.symptoms_id_entry').last().after(div_to_be_appended);
                          $(".symptcat_entry").change(function (event) {
                          // console.log(this.value);
                          // console.log(this.parentElement.nextElementSibling);
                          var t=this.parentElement.nextElementSibling.children[1];
                          // console.log(this.parentElement.nextElementSibling.children[1]);
                          var str_="";
                          $.ajax({
                            type: "GET",
                            url: '/doctor/getsymptajax/{{user.user_name}}',
                            data: {
                              'catid': this.value,
                            },
                            dataType: 'json',
                            complete: function(){
                              $('#preloader').hide();
                            },
                            success:function(data)
                            {
                              while (t.children.length > 1) {
                                t.removeChild(t.lastElementChild);
                              }
                              for(var i=0;i<data.names.length;i++)
                              {
                                str_+="<option value='"+data.ids[i]+"'>"+data.names[i]+"</select>"
                              }
                              t.insertAdjacentHTML('beforeend',str_); 
                            },
                            error : function(xhr,errmsg,err) {
                              alert(xhr.status + ": " + xhr.responseText); 
                            }
                          });
                          // console.log(this.parentElement.nextElementSibling.children[1],str_);
                          });
                          }

                          function add_disease_form()
                          {
                            var div_to_be_appended = $("<div class='diseases_id_entry row'></div>").html('<div class="form-group col-sm-5"> <label class="control-label" for="dis_cat_entry">Disease Category</label> <select  class="form-control dis_cat_entry" id="dis_cat_entry" name="dis_cat_entry" required> <option selected>--Select from below--</option> {% for x in dis_cat %} <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option> {% endfor %} </select> </div> <div class="form-group col-sm-5"> <label class="control-label" for="dis_entry">Disease Name</label> <select  class="form-control dis_entry" id="dis_entry" name="dis_entry" required> <option selected>--Select from below--</option> </select> </div> <div class=" col-sm-2"> <button type="button" class="btn btn-primary my-3 py-3" onclick="delete_e(this)"> Delete</button> </div>');
                          // console.log(div_to_be_appended.html());
                          $('.diseases_id_entry').last().after(div_to_be_appended);
                          $(".dis_cat_entry").change(function (event) {
                          // console.log(this.value);
                          // console.log(this.parentElement.nextElementSibling);
                          var t=this.parentElement.nextElementSibling.children[1];
                          // console.log(this.parentElement.nextElementSibling.children[1]);
                          var str_="";
                          $.ajax({
                            type: "GET",
                            url: '/doctor/getdisajax/{{user.user_name}}',
                            data: {
                              'catid': this.value,
                            },
                            dataType: 'json',
                            complete: function(){
                              $('#preloader').hide();
                            },
                            success:function(data)
                            {
                              while (t.children.length > 1) {
                                t.removeChild(t.lastElementChild);
                              }
                              for(var i=0;i<data.names.length;i++)
                              {
                                str_+="<option value='"+data.ids[i]+"'>"+data.names[i]+"</select>"
                              }
                              t.insertAdjacentHTML('beforeend',str_); 
                            },
                            error : function(xhr,errmsg,err) {
                              alert(xhr.status + ": " + xhr.responseText); 
                            }
                          });
                          // console.log(this.parentElement.nextElementSibling.children[1],str_);
                          });
                          }



                          // KAVILVVVVVVVVVVVVVVVVVVVVVVVVV
                          function add_inj_form()
                          {
                            var div_to_be_appended = $("<div class='inj_id_entry row'></div>").html('<div class="form-group col-sm-10"> <label class="control-label" for="inj_entry">Injuries Name</label> <select  class="form-control inj_entry"  name="inj_entry" required> <option selected>--Select from below--</option> {% for x in inj_sel %} <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>  {% endfor %}</select> </div> <div class=" col-sm-2"> <button type="button" class="btn btn-primary my-3 py-3" onclick="delete_e(this)"> Delete</button> </div>');
                          // console.log(div_to_be_appended.html());
                          $('.inj_id_entry').last().after(div_to_be_appended);
                          
                          }
                          function add_med_form()
                          {
                            var div_to_be_appended = $("<div class='med_id_entry row'></div>").html('<div class="form-group col-sm-4"> <input class="form-control med_name"    placeholder="Medicine Name" /> </div> <div class="form-group col-sm-3"> <input class="form-control med_dos"    placeholder="Medicine Dosage" /> </div> <div class="form-group col-sm-3"> <input class="form-control med_qnt"    placeholder="Medicine Quantity" /> </div> <div class=" col-sm-2"> <button type="button" class="btn btn-primary" onclick="delete_e(this)"> Delete</button> </div>');
                          // console.log(div_to_be_appended.html());
                          $('.med_id_entry').last().after(div_to_be_appended);
                          
                          }

                          function add_lab_form()
                          {
                            var div_to_be_appended = $("<div class='lab_id_entry row'></div>").html('<div class="form-group col-sm-10"> <input class="form-control lab_name"    placeholder="Test Name"  /> </div> <div class=" col-sm-2"> <button type="button" class="btn btn-primary" onclick="delete_e(this)"> Delete</button> </div>');
                          // console.log(div_to_be_appended.html());
                          $('.lab_id_entry').last().after(div_to_be_appended);
                          
                          }
                          


                          function add_sympt_and_dis() {
                            var t=document.getElementsByClassName('sympt_entry');
                            // console.log(t);
                            var rr=[]
                            for(var i=0;i<t.length;i++)
                            {
                              var sympt_Entry=parseInt(t[i].value);
                              if(!isNaN(sympt_Entry))
                              {
                                rr.push(sympt_Entry);
                              }
                            }
                          //Remove Duplicates
                          function removeDuplicates(array) {
                            let x = {};
                            array.forEach(function(i) {
                              if(!x[i]) {
                                x[i] = true
                              }
                            })
                            return Object.keys(x)
                          };
                          rr=removeDuplicates(rr);
                          myJSON = JSON.stringify(rr);
                          // document.getElementById('SymptomCheckResult').innerHTML+=myJSON;
                          document.getElementById('final_symptom').value=myJSON;

                          var t=document.getElementsByClassName('dis_entry');
                            // console.log(t);
                            var rr=[]
                            for(var i=0;i<t.length;i++)
                            {
                              var sympt_Entry=parseInt(t[i].value);
                              if(!isNaN(sympt_Entry))
                              {
                                rr.push(sympt_Entry);
                              }
                            }
                          
                          rr=removeDuplicates(rr);
                          myJSON = JSON.stringify(rr);
                          // document.getElementById('DiseaseCheckResult').innerHTML+=myJSON;
                          document.getElementById('final_disease').value=myJSON;



                          var t=document.getElementsByClassName('inj_entry');
                            // console.log(t);
                            var rr=[]
                            for(var i=0;i<t.length;i++)
                            {
                              var sympt_Entry=parseInt(t[i].value);
                              if(!isNaN(sympt_Entry))
                              {
                                rr.push(sympt_Entry);
                              }
                            }
                          
                          rr=removeDuplicates(rr);
                          myJSON = JSON.stringify(rr);
                          // document.getElementById('DiseaseCheckResult').innerHTML+=myJSON;
                          document.getElementById('final_injury_type').value=myJSON;

                          var t=document.getElementsByClassName('med_name');
                          var rr=[]
                          for(var i=0;i<t.length;i++)
                          {
                            rr.push(t[i].value);
                          }
                          myJSON = JSON.stringify(rr);
                         
                          document.getElementById('final_med_name').value=myJSON;

                          var t=document.getElementsByClassName('med_dos');
                          var rr=[]
                          for(var i=0;i<t.length;i++)
                          {
                            rr.push(t[i].value);
                          }
                          myJSON = JSON.stringify(rr);
                          document.getElementById('final_med_dos').value=myJSON;

                          var t=document.getElementsByClassName('med_qnt');
                          var rr=[]
                          for(var i=0;i<t.length;i++)
                          {
                            rr.push(t[i].value);
                          }
                          myJSON = JSON.stringify(rr);
                          
                          document.getElementById('final_med_qnt').value=myJSON;


                          var t=document.getElementsByClassName('lab_name');
                          var rr=[]
                          for(var i=0;i<t.length;i++)
                          {
                            rr.push(t[i].value);
                          }
                          myJSON = JSON.stringify(rr);
                          
                          document.getElementById('final_lab_test').value=myJSON;
                            return true;
                          }
                          
                     </script>
                     
                     <!-- <button type="button"   class="btn btn-primary my-2" onclick="return SymptomCheckFunc()">
                     Click here to Check test</button>
                     
                     <button type="button"   class="btn btn-primary my-2" onclick="return DiseaseCheckFunc()">
                     Click here to Check test(Disease)</button> -->
                     <!-- <p>Symptoms:</p>
                     <p id="SymptomCheckResult"></p>
                     <p>Diseases:</p>
                     <p id="DiseaseCheckResult"></p> -->
                     <!-- <button onclick="return add_sympt_and_dis()">This is for TESTING</button> -->
                     <form class="user" action="" method='POST' onsubmit="return add_sympt_and_dis()">
                        {% csrf_token %}
                        <h1 class="h4 text-gray-900 mb-4">Fill Symptoms</h1>
                        <div class='symptoms_id_entry row'>
                           <div class="form-group col-sm-6">
                              <label class="control-label" for="symptcat_entry">Symptom Category</label>
                              <select  class="form-control symptcat_entry" id="symptcat_entry" name="symptcat_entry" required>
                                 <option selected>--Select from below--</option>
                                 {% for x in sys_cat %}
                                 <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>
                                 {% endfor %}
                              </select>
                           </div>
                           <div class="form-group col-sm-6">
                              <label class="control-label" for="sympt_entry">Symptom Name</label>
                              <select  class="form-control sympt_entry" id="sympt_entry" name="sympt_entry" required>
                                 <option selected>--Select from below--</option>
                              </select>
                           </div>
                           <!-- <input type="text" class="fair" id="head" placeholder="Subject">
                              <input type="text" class="fair" id="tail" placeholder="Data"> -->
                        </div>
                        <button type="button"  id="add_class_sympt" onclick="add_sympt_form()" class="btn btn-primary my-2">
                     Click here to Add new Symptom in this form</button>
                        <h1 class="h4 text-gray-900 mb-4">Fill Diseases</h1>
                        <div class='diseases_id_entry row'>
                           <div class="form-group col-sm-6">
                              <label class="control-label" for="dis_cat_entry">Disease Category</label>
                              <select  class="form-control dis_cat_entry" id="dis_cat_entry" name="dis_cat_entry" required>
                                 <option selected>--Select from below--</option>
                                 {% for x in dis_cat %}
                                 <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>
                                 {% endfor %}
                              </select>
                           </div>
                           <div class="form-group col-sm-6">
                              <label class="control-label" for="dis_entry">Disease Name</label>
                              <select  class="form-control dis_entry" id="dis_entry" name="dis_entry" required>
                                 <option selected>--Select from below--</option>
                              </select>
                           </div>
                           <!-- <input type="text" class="fair" id="head" placeholder="Subject">
                              <input type="text" class="fair" id="tail" placeholder="Data"> -->
                        </div>
                        <button type="button"  id="add_class_dis" onclick="add_disease_form()" class="btn btn-primary my-2">
                     Click here to Add new Disease in this form</button>
                        <h1 class="h4 text-gray-900 mb-4">Fill Injuries</h1>
                        <div class='inj_id_entry row'>
                           <div class="form-group col-sm-12">
                              <label class="control-label" for="inj_entry">Injuries Name</label>
                              <select  class="form-control inj_entry"  name="inj_entry" required>
                                 <option selected>--Select from below--</option>
                                 {% for x in inj_sel %}
                                 <option value="{{x.id}}"title="{{x.description}}">{{x.name}}</option>
                                 {% endfor %}
                              </select>
                           </div>
                          
                        </div>
                        <button type="button"  id="add_class_inj" onclick="add_inj_form()" class="btn btn-primary my-2">
                     Click here to Add new Injuries in this form</button>
                     <h1 class="h4 text-gray-900 mb-4">Write Medicines</h1>
                        <div class='med_id_entry row'>
                           <div class="form-group col-sm-4">
                              <input class="form-control med_name"    placeholder="Medicine Name"  />
                            </div>
                            <div class="form-group col-sm-4">
                              <input class="form-control med_dos"    placeholder="Medicine Dosage" />
                            </div>
                            <div class="form-group col-sm-4">
                              <input class="form-control med_qnt"    placeholder="Medicine Quantity" />                               
                           </div>
                          
                        </div>
                        <button type="button"  id="add_class_med" onclick="add_med_form()" class="btn btn-primary my-2">
                     Click here to Add new Medicines in this form</button>

                     <h1 class="h4 text-gray-900 mb-4">Prescribe Laboratorical Tests</h1>
                        <div class='lab_id_entry row'>
                           <div class="form-group col-sm-12">
                              <input class="form-control lab_name"    placeholder="Test Name"  />
                            </div>
                        </div>
                        <button type="button"  id="add_class_lab" onclick="add_lab_form()" class="btn btn-primary my-2">
                     Click here to Add new Lab Tests in this form</button>
                        <input type="text" name="symptoms" id="final_symptom" hidden >
                        <input type="text" name="diseases" id="final_disease" hidden >
                        <input type="text" name="injury_type" id="final_injury_type" hidden >
                        <input type="text" name="med_name" id="final_med_name"  hidden>
                        <input type="text" name="med_dos" id="final_med_dos"  hidden>
                        <input type="text" name="med_qnt" id="final_med_qnt"  hidden>
                        <input type="text" name="lab_test" id="final_lab_test"  hidden>
                        <textarea type="text" class="form-control m-1 "  name="general_notes" placeholder="Enter General Notes for Other Doctors in this Case" required></textarea>
                        <textarea type="text" class="form-control m-1 "  name="personal_notes" placeholder="Enter Personal Notes for your own reference in this Case(It won't be Discolsed)" required></textarea>
                        <div class="container m-2">
                            <div class=" row">
                               <div class="col-sm-6">
                                  <label class="form-check-label">
                                  <input type="radio" class="form-check-input"  value="1" name="is_accidental" checked>It is a Case of Injury
                                  </label>
                               </div>
                               <div class="col-sm-6">
                                  <label class="form-check-label">
                                  <input type="radio" class="form-check-input" name="is_accidental" value="0" >It is not a Case of Injury 
                                  </label>
                               </div>
                            </div>
                      </div>
                       <div class="container m-2">
                            <div class=" row">
                               <div class="col-sm-6">
                                  <label class="form-check-label">
                                  <input type="radio" class="form-check-input"  value="1" name="is_closed" checked>It is a Case CLOSED
                                  </label>
                               </div>
                               <div class="col-sm-6">
                                  <label class="form-check-label">
                                  <input type="radio" class="form-check-input" name="is_closed" value="0" >Patient still requires treatment 
                                  </label>
                               </div>
                            </div>
                      </div>
                        <center>
                              <input type="submit" name="submit" class="btn btn-danger btn-user btn-block w-50 m-2">
                              </center>
                        <hr>
                     </form>
                  </div>
               </div>
            </div>
         </div>
         <!-- /.container-fluid -->
      </div>
      <!-- End of Main Content -->
      <!-- Footer -->
      <footer class="sticky-footer bg-white">
         <div class="container my-auto">
            <div class="copyright text-center my-auto">
               <span>Copyright &copy; Your Website </span><span id="year-current"></span>
            </div>
         </div>
      </footer>
      <!-- End of Footer -->
   </div>
   <!-- End of Content Wrapper -->
</div>
<!-- End of Page Wrapper -->
<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
<i class="fas fa-angle-up"></i>
</a>
<script type="text/javascript">
   document.getElementById('year-current').innerHTML=new Date().getFullYear();
</script> 



<!-- Page level plugins -->
<script src="{% static 'dashboard/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- Core plugin JavaScript-->
<script src="{% static 'dashboard/vendor/jquery-easing/jquery.easing.min.js' %}"></script>
<!-- Custom scripts for all pages-->
<script src="{% static 'dashboard/vendor/jquery/datepicker.min.js' %}"></script>
<script src="{% static 'dashboard/js/sb-admin-2.min.js' %}"></script>
<!-- Page level plugins -->
<script src="{% static 'dashboard/vendor/datatables/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'dashboard/vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>
<!-- Page level custom scripts -->
<script src="{% static 'dashboard/js/demo/datatables-demo.js' %}"></script>
<script type="text/javascript">
   $(".symptcat_entry").change(function (event) {
   // console.log(this.value);
   // console.log(this.parentElement.nextElementSibling);
   var t=this.parentElement.nextElementSibling.children[1];
   // console.log(this.parentElement.nextElementSibling.children[1]);
    var str_="";
   $.ajax({
       type: "GET",
       url: '/doctor/getsymptajax/{{user.user_name}}',
       data: {
         'catid': this.value,
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
          while (t.children.length > 1) {
               t.removeChild(t.lastElementChild);
           }
         
         for(var i=0;i<data.names.length;i++)
         {
           str_+="<option value='"+data.ids[i]+"'>"+data.names[i]+"</select>"
         }
         t.insertAdjacentHTML('beforeend',str_); 
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
   // console.log(this.parentElement.nextElementSibling.children[1],str_);
   });
   function csrfSafeMethod(method) {
   // these HTTP methods do not require CSRF protection
   return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
   }
   var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
   $.ajaxSetup({
   beforeSend: function(xhr, settings) {
     $('#preloader').show();
       if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
           xhr.setRequestHeader("X-CSRFToken", csrftoken);
       }
       
        
   }
   });
   // $('#loader').bind('ajaxStart', function(){
   
   //     $(this).show();
   // }).bind('ajaxStop', function(){
   //     $(this).hide();
   // });
   $("#symptom_sub").submit(function (event) {
     event.preventDefault();
     $.ajax({
       type: "POST",
       url: '/doctor/addsymptajax/{{user.user_name}}',
       data: {
         'symptom_name': $("#symptom_name").val(),
         'symptom_desc': $("#symptom_desc").val(),
         'symptom_cat_select_modal':$("#symptom_cat_select_modal").val(),
         'alternate_name':$("#alternate_name").val()
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
         alert(data.result);
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
       return false;
   });
   
   
   
   $("#symptom_cat").submit(function (event) {
     event.preventDefault();
     $.ajax({
       type: "POST",
       url: '/doctor/addsymptcatajax/{{user.user_name}}',
       data: {
         'symptom_name': $("#symptom_cat_name").val(),
         'symptom_desc': $("#symptom_cat_desc").val(),
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
         alert(data.result);
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
       return false;
   });
   
   $("#disease_cat").submit(function (event) {
     event.preventDefault();
     $.ajax({
       type: "POST",
       url: '/doctor/adddiseasecatajax/{{user.user_name}}',
       data: {
         'disease_cat_name': $("#disease_cat_name").val(),
         'disease_cat_desc': $("#disease_cat_desc").val(),
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
         alert(data.result);
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
       return false;
   });
   
   $("#disease_sub").submit(function (event) {
     event.preventDefault();
     $.ajax({
       type: "POST",
       url: '/doctor/adddiseaseajax/{{user.user_name}}',
       data: {
         'disease_name': $("#disease_name").val(),
         'disease_desc': $("#disease_desc").val(),
         'disease_cat_select_modal':$("#disease_cat_select_modal").val(),
         'alternate_name':$("#dis_alternate_name").val(),
         'dis_int':$("#dis_int").val()
   
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
         alert(data.result);
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
       return false;
   });
   
   $(".dis_cat_entry").change(function (event) {
    // console.log(this.value);
    // console.log(this.parentElement.nextElementSibling);
    var t=this.parentElement.nextElementSibling.children[1];
    // console.log(this.parentElement.nextElementSibling.children[1]);
    var str_="";
    $.ajax({
      type: "GET",
      url: '/doctor/getdisajax/{{user.user_name}}',
      data: {
        'catid': this.value,
      },
      dataType: 'json',
      complete: function(){
        $('#preloader').hide();
      },
      success:function(data)
      {
        while (t.children.length > 1) {
          t.removeChild(t.lastElementChild);
        }
        for(var i=0;i<data.names.length;i++)
        {
          str_+="<option value='"+data.ids[i]+"'>"+data.names[i]+"</select>"
        }
        t.insertAdjacentHTML('beforeend',str_); 
      },
      error : function(xhr,errmsg,err) {
        alert(xhr.status + ": " + xhr.responseText); 
      }
    });
    // console.log(this.parentElement.nextElementSibling.children[1],str_);
    });
   
   
   
   
   
   $("#injury_form").submit(function (event) {
     event.preventDefault();
     $.ajax({
       type: "POST",
       url: '/doctor/addinjajax/{{user.user_name}}',
       data: {
         'injury_name': $("#injury_name").val(),
         'inj_alternate_name': $("#inj_alternate_name").val(),
         'injury_desc':$("#injury_desc").val(),
         'inj_sev':$("#inj_sev").val(),
       },
       dataType: 'json',
       complete: function(){
       $('#preloader').hide();
       },
       success:function(data)
       {
         alert(data.result);
       },
       error : function(xhr,errmsg,err) {
          alert(xhr.status + ": " + xhr.responseText); 
       }
     });
       return false;
   }); 
   $(document).ready( function () {
    $('#dataTable2').DataTable();
     // $('.dataTable').DataTable();
     $.ajax({
         type: "GET",
         url: '/doctor/get_cons_doc/{{user.user_name}}',
         data: {
           'case_id': "{{case_id}}"
         },
         dataType: 'json',
         complete: function(){
         $('#preloader').hide();
         },
         success:function(data)
         {
          // console.log(data.result);
          xxx=JSON.parse(data.result);
          strr="";
          $("#tbody2-"+"{{case_id}}").empty();
          // console.log("Kavil 's Tesr"+$("#tbody2-"+"{{case_id}}").html());
          for (var i = 0; i < xxx.length; i++) {
              if(xxx[i].fields['logoutTime']==null)
              {
                // console.log("continue");
                continue;
              }  
            var date_= new Date(xxx[i].fields['logoutTime']);
            var dd = date_.getDate();
            var mm = date_.getMonth() + 1; //January is 0!

            var yyyy = date_.getFullYear();
            if (dd < 10) {
              dd = '0' + dd;
            } 
            if (mm < 10) {
              mm = '0' + mm;
            } 
            var disp_date = dd + '/' + mm + '/' + yyyy;
            strr="<tr><td>"+disp_date+"</td><td>"+xxx[i].fields['symptoms']+"</td><td>"+xxx[i].fields['injury_type']+"</td><td>"+xxx[i].fields['diseases']+"</td><td>"+xxx[i].fields['personal_notes']+"</td><td>"+xxx[i].fields['general_notes']+"</td><td>"+xxx[i].fields['is_accidental']+"</td></tr>"
            // console.log(xxx[i].fields);
            // console.log($("#tbody2-"+"{{case_id}}").html());
            $("#tbody2-"+"{{case_id}}").append(strr);
            // console.log("Kavil 's Tesrt"+$("#tbody2-"+"{{case_id}}").html());

          }
          // console.log($("#tbody2-"+"{{case_id}}").html());
           
         },
         error : function(xhr,errmsg,err) {
            alert(xhr.status + ": " + xhr.responseText); 
         }
       });
    
} );
    
   function getajaxconsultancy(tt) {
       $.ajax({
         type: "GET",
         url: '/doctor/get_cons_doc/{{user.user_name}}',
         data: {
           'case_id': tt
         },
         dataType: 'json',
         complete: function(){
         $('#preloader').hide();
         },
         success:function(data)
         {
          // console.log(data.result);
          xxx=JSON.parse(data.result);
          // console.log(xxx);
          strr="";
          $("#tbody-"+tt).empty();
          for (var i = 0; i < xxx.length; i++) {  
            var date_= new Date(xxx[i].fields['logoutTime']);
            // console.log(date_);
            var dd = date_.getDate();
            var mm = date_.getMonth() + 1; //January is 0!

            var yyyy = date_.getFullYear();
            if (dd < 10) {
              dd = '0' + dd;
            } 
            if (mm < 10) {
              mm = '0' + mm;
            } 
            var disp_date = dd + '/' + mm + '/' + yyyy;
            strr="<tr><td>"+disp_date+"</td><td>"+xxx[i].fields['symptoms']+"</td><td>"+xxx[i].fields['injury_type']+"</td><td>"+xxx[i].fields['diseases']+"</td><td>"+xxx[i].fields['personal_notes']+"</td><td>"+xxx[i].fields['general_notes']+"</td><td>"+xxx[i].fields['is_accidental']+"</td></tr>"
            // console.log(xxx[i].fields);  
            $("#tbody-"+tt).append(strr);
         
          }
           
         },
         error : function(xhr,errmsg,err) {
            alert(xhr.status + ": " + xhr.responseText); 
         }
       });
       $.ajax({
         type: "GET",
         url: '/doctor/get_cons_medicine/{{user.user_name}}',
         data: {
           'case_id': tt
         },
         dataType: 'json',
         complete: function(){
         $('#preloader').hide();
         },
         success:function(data)
         {
          
          xxx=JSON.parse(data.result);
          // console.log(xxx);
          strr="";
          $("#tbody4-"+tt).empty();
          for (var i = 0; i < xxx.length; i++) {
            strr="<tr><td>"+xxx[i]['medicine_name']+"</td><td>"+xxx[i]['dosage']+"</td><td>"+xxx[i]['quantity']+"</td><td>"+xxx[i]['is_delivered']+"</td></tr>";
            console.log(xxx[i]);
            $("#tbody4-"+tt).append(strr);
         
          }
           
         },
         error : function(xhr,errmsg,err) {
            alert(xhr.status + ": " + xhr.responseText); 
         }
       });
      
       
   }

 function getajaxlab(tt) {
         $.ajax({
         type: "POST",
         url: '/doctor/getajaxlab/{{user.user_name}}',
         data: {
           'case_id': tt
         },
         dataType: 'json',
         complete: function(){
         $('#preloader').hide();
         },
         success:function(data)
         {
          xxx=JSON.parse(data.result);
           strr="";
            strr="";
          $("#tbody5-"+tt).empty();
          for (var i = 0; i < xxx.length; i++) {
            strr="<tr><td>"+xxx[i]['name']+"</td><td>"+xxx[i]['ref_date']+"</td><td>"+xxx[i]['deliv_date']+"</td><td>"+xxx[i]['is_delivered']+"</td><td>"+xxx[i]['lab_desc']+"</td><td>";
            for(var jj=0;jj<xxx[i]['files'].length;jj++)
            {
              strr+="<a href='"+xxx[i]['files'][jj]+"' download class='btn btn-primary m-2'>download</a>"
            }
            strr+="</td></tr>";
            //+xxx[i]['files']+"</td></tr>";
            console.log(xxx[i]);
            $("#tbody5-"+tt).append(strr);
         
          }
          // alert(data.result);           
         },
         error : function(xhr,errmsg,err) {
            alert(xhr.status + ": " + xhr.responseText); 
         }
       });



 }
   function delete_med_entry(tt) {
    // console.log(tt);
    var confirm_e=confirm("Do you want to delete Medicine of User {{user_patient.firstname}} {{user_patient.lastname}}  id="+tt);
    if (confirm_e==true)
    {


       $.ajax({
         type: "POST",
         url: '/doctor/delete_med_entry/{{user.user_name}}',
         data: {
           'case_id': tt
         },
         dataType: 'json',
         complete: function(){
         $('#preloader').hide();
         },
         success:function(data)
         {
          alert(data.result);           
         },
         error : function(xhr,errmsg,err) {
            alert(xhr.status + ": " + xhr.responseText); 
         }
       });
      
       
   }
 }
 $('.dataTable').DataTable();

</script>
{% endblock %}